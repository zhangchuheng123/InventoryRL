# Configurate Environments

```bash
conda create -n inv python=3.10
conda activate inv
conda install pytorch torchvision torchaudio pytorch-cuda=11.8 -c pytorch -c nvidia
conda install matplotlib numpy pandas scipy
conda install -c conda-forge scikit-learn
pip install pyyaml munch tqdm tensorboard gym[atari] pathos wandb[azure]
```

# Instruction for Section 7.4

The main results can be collected by running ``bash train.sh``. The specific instructions are as follows:

- The results of our algorithm in Table 4 and Figure 6 are generated by running ``sac_discrete.py`` using the config file ``default.yaml`` with keywords ``num_product`` and ``target_budget_discount`` modified as the number of product N and average threshold q/N correspondingly.
- The results of benchmark algorithms in Table 4 are generated by running ``classical.py`` using the config file ``default.yaml``.
- The results of Figure 7 are generated by running ``additional_experiment_sample_cost.py``.
- The results of Table 5 are generated by running ``additional_experiment_network.py``.
- The results of Figure 9 are generated by running ``additional_experiment_subgradient.py``.

All programs will generate results and log the results in Weights & Biases ([https://wandb.ai](https://wandb.ai/)) as well as TensorBoard. The results in tables can be read from these sources accordingly. The figures are plotted using matplotlib ([https://matplotlib.org](https://matplotlib.org/)) based on the data downloaded from these sources.

# Hardware

Our experiments run on a machine with the following requirements:
* System: Ubuntu 18.04.6 LTS
* CPU: 36x Intel(R) Xeon(R) Gold 6154 CPU @ 3.00GHz
* GPU: 2x NVIDIA GeForce RTX 3090
* GPU driver: Nvidia driver 535.146.02 with CUDA version 12.2
* Python version and packages: python-3.10 with all packages specified in ``environment.yaml``

# Running Time

- Each single run corresponding to one row in Table 4/Table 5 or one curve in Figure 6 takes 30.96 hours on average.
- Each single run corresponding to one sample in Figure 7 takes 33.83 hours on average.
- Each single run of the experiments of the subgradient algorithm takes less than 184 hours (with state dimension equaling 12), and that of our algorithm takes 34 hours.
- The algorithms usually take less time to converge, and we report the time needed for completing prescribed number of iterations.